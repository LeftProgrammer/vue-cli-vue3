define(["./Matrix4-3b2c0630","./combine-3c023bda","./AttributeCompression-cf8328fe","./Ellipsoid-119327cb","./Math-c2b1b304","./IndexDatatype-266e701d","./Matrix2-115e2170","./createTaskProcessorWorker","./RuntimeError-8952249c","./defaultValue-81eec7ed","./ComponentDatatype-c4f4738c","./WebGLConstants-508b9636"],(function(e,t,a,n,r,s,i,o,c,u,f,p){"use strict";const d=32767,l=new n.Cartographic,b=new e.Cartesian3;const C=new i.Rectangle,w=new n.Ellipsoid,h=new e.Cartesian3,y={min:void 0,max:void 0};const k=new e.Cartesian3,m=new e.Cartesian3,A=new e.Cartesian3,g=new e.Cartesian3,x=new e.Cartesian3;return o((function(o,c){const u=new Uint16Array(o.positions),f=new Uint16Array(o.widths),p=new Uint32Array(o.counts),E=new Uint16Array(o.batchIds);!function(t){t=new Float64Array(t);let a=0;y.min=t[a++],y.max=t[a++],i.Rectangle.unpack(t,a,C),a+=i.Rectangle.packedLength,n.Ellipsoid.unpack(t,a,w),a+=n.Ellipsoid.packedLength,e.Cartesian3.unpack(t,a,h)}(o.packedBuffer);const D=w,I=h,P=function(t,s,i,o,c){const u=t.length/3,f=t.subarray(0,u),p=t.subarray(u,2*u),C=t.subarray(2*u,3*u);a.AttributeCompression.zigZagDeltaDecode(f,p,C);const w=new Float64Array(t.length);for(let t=0;t<u;++t){const a=f[t],u=p[t],h=C[t],y=r.CesiumMath.lerp(s.west,s.east,a/d),k=r.CesiumMath.lerp(s.south,s.north,u/d),m=r.CesiumMath.lerp(i,o,h/d),A=n.Cartographic.fromRadians(y,k,m,l),g=c.cartographicToCartesian(A,b);e.Cartesian3.pack(g,w,3*t)}return w}(u,C,y.min,y.max,D),U=P.length/3,M=4*U-4,R=new Float32Array(3*M),T=new Float32Array(3*M),F=new Float32Array(3*M),N=new Float32Array(2*M),L=new Uint16Array(M);let S,_=0,v=0,G=0,W=0,B=p.length;for(S=0;S<B;++S){const t=p[S],a=f[S],n=E[S];for(let r=0;r<t;++r){let s;if(0===r){const t=e.Cartesian3.unpack(P,3*W,k),a=e.Cartesian3.unpack(P,3*(W+1),m);s=e.Cartesian3.subtract(t,a,A),e.Cartesian3.add(t,s,s)}else s=e.Cartesian3.unpack(P,3*(W+r-1),A);const i=e.Cartesian3.unpack(P,3*(W+r),g);let o;if(r===t-1){const a=e.Cartesian3.unpack(P,3*(W+t-1),k),n=e.Cartesian3.unpack(P,3*(W+t-2),m);o=e.Cartesian3.subtract(a,n,x),e.Cartesian3.add(a,o,o)}else o=e.Cartesian3.unpack(P,3*(W+r+1),x);e.Cartesian3.subtract(s,I,s),e.Cartesian3.subtract(i,I,i),e.Cartesian3.subtract(o,I,o);const c=r===t-1?2:4;for(let t=0===r?2:0;t<c;++t){e.Cartesian3.pack(i,R,_),e.Cartesian3.pack(s,T,_),e.Cartesian3.pack(o,F,_),_+=3;const r=t-2<0?-1:1;N[v++]=t%2*2-1,N[v++]=r*a,L[G++]=n}}W+=t}const O=s.IndexDatatype.createTypedArray(M,6*U-6);let z=0,H=0;for(B=U-1,S=0;S<B;++S)O[H++]=z,O[H++]=z+2,O[H++]=z+1,O[H++]=z+1,O[H++]=z+2,O[H++]=z+3,z+=4;c.push(R.buffer,T.buffer,F.buffer),c.push(N.buffer,L.buffer,O.buffer);let V={indexDatatype:2===O.BYTES_PER_ELEMENT?s.IndexDatatype.UNSIGNED_SHORT:s.IndexDatatype.UNSIGNED_INT,currentPositions:R.buffer,previousPositions:T.buffer,nextPositions:F.buffer,expandAndWidth:N.buffer,batchIds:L.buffer,indices:O.buffer};if(o.keepDecodedPositions){const e=function(e){const t=e.length,a=new Uint32Array(t+1);let n=0;for(let r=0;r<t;++r)a[r]=n,n+=e[r];return a[t]=n,a}(p);c.push(P.buffer,e.buffer),V=t.combine(V,{decodedPositions:P.buffer,decodedPositionOffsets:e.buffer})}return V}))}));
