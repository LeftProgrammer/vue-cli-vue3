define(["exports","./GeometryOffsetAttribute-8c5e10db","./Transforms-51e2663f","./Matrix2-115e2170","./Matrix4-3b2c0630","./ComponentDatatype-c4f4738c","./CylinderGeometryLibrary-ceeaaaea","./defaultValue-81eec7ed","./RuntimeError-8952249c","./GeometryAttribute-8f0cc508","./GeometryAttributes-32b29525","./IndexDatatype-266e701d","./Math-c2b1b304","./VertexFormat-a0b706b0"],(function(t,e,n,a,o,r,i,s,u,m,c,l,p,d){"use strict";const y=new a.Cartesian2,f=new o.Cartesian3,b=new o.Cartesian3,A=new o.Cartesian3,x=new o.Cartesian3;function g(t){const e=(t=s.defaultValue(t,s.defaultValue.EMPTY_OBJECT)).length,n=t.topRadius,a=t.bottomRadius,o=s.defaultValue(t.vertexFormat,d.VertexFormat.DEFAULT),r=s.defaultValue(t.slices,128);this._length=e,this._topRadius=n,this._bottomRadius=a,this._vertexFormat=d.VertexFormat.clone(o),this._slices=r,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}g.packedLength=d.VertexFormat.packedLength+5,g.pack=function(t,e,n){return n=s.defaultValue(n,0),d.VertexFormat.pack(t._vertexFormat,e,n),n+=d.VertexFormat.packedLength,e[n++]=t._length,e[n++]=t._topRadius,e[n++]=t._bottomRadius,e[n++]=t._slices,e[n]=s.defaultValue(t._offsetAttribute,-1),e};const _=new d.VertexFormat,h={vertexFormat:_,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};let F;g.unpack=function(t,e,n){e=s.defaultValue(e,0);const a=d.VertexFormat.unpack(t,e,_);e+=d.VertexFormat.packedLength;const o=t[e++],r=t[e++],i=t[e++],u=t[e++],m=t[e];return s.defined(n)?(n._vertexFormat=d.VertexFormat.clone(a,n._vertexFormat),n._length=o,n._topRadius=r,n._bottomRadius=i,n._slices=u,n._offsetAttribute=-1===m?void 0:m,n):(h.length=o,h.topRadius=r,h.bottomRadius=i,h.slices=u,h.offsetAttribute=-1===m?void 0:m,new g(h))},g.createGeometry=function(t){let u=t._length;const d=t._topRadius,g=t._bottomRadius,_=t._vertexFormat,h=t._slices;if(u<=0||d<0||g<0||0===d&&0===g)return;const F=h+h,v=h+F,C=F+F,w=i.CylinderGeometryLibrary.computePositions(u,d,g,h,!0),G=_.st?new Float32Array(2*C):void 0,R=_.normal?new Float32Array(3*C):void 0,V=_.tangent?new Float32Array(3*C):void 0,D=_.bitangent?new Float32Array(3*C):void 0;let T;const O=_.normal||_.tangent||_.bitangent;if(O){const t=_.tangent||_.bitangent;let e=0,n=0,a=0;const r=Math.atan2(g-d,u),i=f;i.z=Math.sin(r);const s=Math.cos(r);let m=A,c=b;for(T=0;T<h;T++){const r=T/h*p.CesiumMath.TWO_PI,u=s*Math.cos(r),l=s*Math.sin(r);O&&(i.x=u,i.y=l,t&&(m=o.Cartesian3.normalize(o.Cartesian3.cross(o.Cartesian3.UNIT_Z,i,m),m)),_.normal&&(R[e++]=i.x,R[e++]=i.y,R[e++]=i.z,R[e++]=i.x,R[e++]=i.y,R[e++]=i.z),_.tangent&&(V[n++]=m.x,V[n++]=m.y,V[n++]=m.z,V[n++]=m.x,V[n++]=m.y,V[n++]=m.z),_.bitangent&&(c=o.Cartesian3.normalize(o.Cartesian3.cross(i,m,c),c),D[a++]=c.x,D[a++]=c.y,D[a++]=c.z,D[a++]=c.x,D[a++]=c.y,D[a++]=c.z))}for(T=0;T<h;T++)_.normal&&(R[e++]=0,R[e++]=0,R[e++]=-1),_.tangent&&(V[n++]=1,V[n++]=0,V[n++]=0),_.bitangent&&(D[a++]=0,D[a++]=-1,D[a++]=0);for(T=0;T<h;T++)_.normal&&(R[e++]=0,R[e++]=0,R[e++]=1),_.tangent&&(V[n++]=1,V[n++]=0,V[n++]=0),_.bitangent&&(D[a++]=0,D[a++]=1,D[a++]=0)}const L=12*h-12,M=l.IndexDatatype.createTypedArray(C,L);let P=0,E=0;for(T=0;T<h-1;T++)M[P++]=E,M[P++]=E+2,M[P++]=E+3,M[P++]=E,M[P++]=E+3,M[P++]=E+1,E+=2;for(M[P++]=F-2,M[P++]=0,M[P++]=1,M[P++]=F-2,M[P++]=1,M[P++]=F-1,T=1;T<h-1;T++)M[P++]=F+T+1,M[P++]=F+T,M[P++]=F;for(T=1;T<h-1;T++)M[P++]=v,M[P++]=v+T,M[P++]=v+T+1;let k=0;if(_.st){const t=Math.max(d,g);for(T=0;T<C;T++){const e=o.Cartesian3.fromArray(w,3*T,x);G[k++]=(e.x+t)/(2*t),G[k++]=(e.y+t)/(2*t)}}const z=new c.GeometryAttributes;_.position&&(z.position=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:w})),_.normal&&(z.normal=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),_.tangent&&(z.tangent=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V})),_.bitangent&&(z.bitangent=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),_.st&&(z.st=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:G})),y.x=.5*u,y.y=Math.max(g,d);const N=new n.BoundingSphere(o.Cartesian3.ZERO,a.Cartesian2.magnitude(y));if(s.defined(t._offsetAttribute)){u=w.length;const n=new Uint8Array(u/3),a=t._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(n,a),z.applyOffset=new m.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new m.Geometry({attributes:z,indices:M,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:N,offsetAttribute:t._offsetAttribute})},g.getUnitCylinder=function(){return s.defined(F)||(F=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:d.VertexFormat.POSITION_ONLY}))),F},t.CylinderGeometry=g}));
