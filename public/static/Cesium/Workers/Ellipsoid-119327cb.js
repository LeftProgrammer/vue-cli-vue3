define(["exports","./Matrix4-3b2c0630","./RuntimeError-8952249c","./defaultValue-81eec7ed","./Math-c2b1b304"],(function(e,t,i,a,n){"use strict";const r=new t.Cartesian3,o=new t.Cartesian3;function u(e,i,u,s,d){const c=e.x,h=e.y,l=e.z,f=i.x,C=i.y,m=i.z,p=c*c*f*f,g=h*h*C*C,_=l*l*m*m,S=p+g+_,y=Math.sqrt(1/S),q=t.Cartesian3.multiplyByScalar(e,y,r);if(S<s)return isFinite(y)?t.Cartesian3.clone(q,d):void 0;const R=u.x,w=u.y,M=u.z,O=o;O.x=q.x*R*2,O.y=q.y*w*2,O.z=q.z*M*2;let v,T,z,x,b,N,A,E,V,I,L,P=(1-y)*t.Cartesian3.magnitude(e)/(.5*t.Cartesian3.magnitude(O)),F=0;do{P-=F,z=1/(1+P*R),x=1/(1+P*w),b=1/(1+P*M),N=z*z,A=x*x,E=b*b,V=N*z,I=A*x,L=E*b,v=p*N+g*A+_*E-1,T=p*V*R+g*I*w+_*L*M;F=v/(-2*T)}while(Math.abs(v)>n.CesiumMath.EPSILON12);return a.defined(d)?(d.x=c*z,d.y=h*x,d.z=l*b,d):new t.Cartesian3(c*z,h*x,l*b)}function s(e,t,i){this.longitude=a.defaultValue(e,0),this.latitude=a.defaultValue(t,0),this.height=a.defaultValue(i,0)}s.fromRadians=function(e,t,i,n){return i=a.defaultValue(i,0),a.defined(n)?(n.longitude=e,n.latitude=t,n.height=i,n):new s(e,t,i)},s.fromDegrees=function(e,t,i,a){return e=n.CesiumMath.toRadians(e),t=n.CesiumMath.toRadians(t),s.fromRadians(e,t,i,a)};const d=new t.Cartesian3,c=new t.Cartesian3,h=new t.Cartesian3,l=new t.Cartesian3(1/6378137,1/6378137,1/6356752.314245179),f=new t.Cartesian3(1/40680631590769,1/40680631590769,1/40408299984661.445),C=n.CesiumMath.EPSILON1;function m(e,i,r,o){i=a.defaultValue(i,0),r=a.defaultValue(r,0),o=a.defaultValue(o,0),e._radii=new t.Cartesian3(i,r,o),e._radiiSquared=new t.Cartesian3(i*i,r*r,o*o),e._radiiToTheFourth=new t.Cartesian3(i*i*i*i,r*r*r*r,o*o*o*o),e._oneOverRadii=new t.Cartesian3(0===i?0:1/i,0===r?0:1/r,0===o?0:1/o),e._oneOverRadiiSquared=new t.Cartesian3(0===i?0:1/(i*i),0===r?0:1/(r*r),0===o?0:1/(o*o)),e._minimumRadius=Math.min(i,r,o),e._maximumRadius=Math.max(i,r,o),e._centerToleranceSquared=n.CesiumMath.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function p(e,t,i){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,m(this,e,t,i)}s.fromCartesian=function(e,i,r){const o=a.defined(i)?i.oneOverRadii:l,m=a.defined(i)?i.oneOverRadiiSquared:f,p=u(e,o,m,a.defined(i)?i._centerToleranceSquared:C,c);if(!a.defined(p))return;let g=t.Cartesian3.multiplyComponents(p,m,d);g=t.Cartesian3.normalize(g,g);const _=t.Cartesian3.subtract(e,p,h),S=Math.atan2(g.y,g.x),y=Math.asin(g.z),q=n.CesiumMath.sign(t.Cartesian3.dot(_,e))*t.Cartesian3.magnitude(_);return a.defined(r)?(r.longitude=S,r.latitude=y,r.height=q,r):new s(S,y,q)},s.toCartesian=function(e,i,a){return t.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,i,a)},s.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new s(e.longitude,e.latitude,e.height)},s.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},s.equalsEpsilon=function(e,t,i){return i=a.defaultValue(i,0),e===t||a.defined(e)&&a.defined(t)&&Math.abs(e.longitude-t.longitude)<=i&&Math.abs(e.latitude-t.latitude)<=i&&Math.abs(e.height-t.height)<=i},s.ZERO=Object.freeze(new s(0,0,0)),s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)},s.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`},Object.defineProperties(p.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),p.clone=function(e,i){if(!a.defined(e))return;const n=e._radii;return a.defined(i)?(t.Cartesian3.clone(n,i._radii),t.Cartesian3.clone(e._radiiSquared,i._radiiSquared),t.Cartesian3.clone(e._radiiToTheFourth,i._radiiToTheFourth),t.Cartesian3.clone(e._oneOverRadii,i._oneOverRadii),t.Cartesian3.clone(e._oneOverRadiiSquared,i._oneOverRadiiSquared),i._minimumRadius=e._minimumRadius,i._maximumRadius=e._maximumRadius,i._centerToleranceSquared=e._centerToleranceSquared,i):new p(n.x,n.y,n.z)},p.fromCartesian3=function(e,t){return a.defined(t)||(t=new p),a.defined(e)?(m(t,e.x,e.y,e.z),t):t},p.WGS84=Object.freeze(new p(6378137,6378137,6356752.314245179)),p.UNIT_SPHERE=Object.freeze(new p(1,1,1)),p.MOON=Object.freeze(new p(n.CesiumMath.LUNAR_RADIUS,n.CesiumMath.LUNAR_RADIUS,n.CesiumMath.LUNAR_RADIUS)),p.prototype.clone=function(e){return p.clone(this,e)},p.packedLength=t.Cartesian3.packedLength,p.pack=function(e,i,n){return n=a.defaultValue(n,0),t.Cartesian3.pack(e._radii,i,n),i},p.unpack=function(e,i,n){i=a.defaultValue(i,0);const r=t.Cartesian3.unpack(e,i);return p.fromCartesian3(r,n)},p.prototype.geocentricSurfaceNormal=t.Cartesian3.normalize,p.prototype.geodeticSurfaceNormalCartographic=function(e,i){const n=e.longitude,r=e.latitude,o=Math.cos(r),u=o*Math.cos(n),s=o*Math.sin(n),d=Math.sin(r);return a.defined(i)||(i=new t.Cartesian3),i.x=u,i.y=s,i.z=d,t.Cartesian3.normalize(i,i)},p.prototype.geodeticSurfaceNormal=function(e,i){if(!t.Cartesian3.equalsEpsilon(e,t.Cartesian3.ZERO,n.CesiumMath.EPSILON14))return a.defined(i)||(i=new t.Cartesian3),i=t.Cartesian3.multiplyComponents(e,this._oneOverRadiiSquared,i),t.Cartesian3.normalize(i,i)};const g=new t.Cartesian3,_=new t.Cartesian3;p.prototype.cartographicToCartesian=function(e,i){const n=g,r=_;this.geodeticSurfaceNormalCartographic(e,n),t.Cartesian3.multiplyComponents(this._radiiSquared,n,r);const o=Math.sqrt(t.Cartesian3.dot(n,r));return t.Cartesian3.divideByScalar(r,o,r),t.Cartesian3.multiplyByScalar(n,e.height,n),a.defined(i)||(i=new t.Cartesian3),t.Cartesian3.add(r,n,i)},p.prototype.cartographicArrayToCartesianArray=function(e,t){const i=e.length;a.defined(t)?t.length=i:t=new Array(i);for(let a=0;a<i;a++)t[a]=this.cartographicToCartesian(e[a],t[a]);return t};const S=new t.Cartesian3,y=new t.Cartesian3,q=new t.Cartesian3;p.prototype.cartesianToCartographic=function(e,i){const r=this.scaleToGeodeticSurface(e,y);if(!a.defined(r))return;const o=this.geodeticSurfaceNormal(r,S),u=t.Cartesian3.subtract(e,r,q),d=Math.atan2(o.y,o.x),c=Math.asin(o.z),h=n.CesiumMath.sign(t.Cartesian3.dot(u,e))*t.Cartesian3.magnitude(u);return a.defined(i)?(i.longitude=d,i.latitude=c,i.height=h,i):new s(d,c,h)},p.prototype.cartesianArrayToCartographicArray=function(e,t){const i=e.length;a.defined(t)?t.length=i:t=new Array(i);for(let a=0;a<i;++a)t[a]=this.cartesianToCartographic(e[a],t[a]);return t},p.prototype.scaleToGeodeticSurface=function(e,t){return u(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},p.prototype.scaleToGeocentricSurface=function(e,i){a.defined(i)||(i=new t.Cartesian3);const n=e.x,r=e.y,o=e.z,u=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*u.x+r*r*u.y+o*o*u.z);return t.Cartesian3.multiplyByScalar(e,s,i)},p.prototype.transformPositionToScaledSpace=function(e,i){return a.defined(i)||(i=new t.Cartesian3),t.Cartesian3.multiplyComponents(e,this._oneOverRadii,i)},p.prototype.transformPositionFromScaledSpace=function(e,i){return a.defined(i)||(i=new t.Cartesian3),t.Cartesian3.multiplyComponents(e,this._radii,i)},p.prototype.equals=function(e){return this===e||a.defined(e)&&t.Cartesian3.equals(this._radii,e._radii)},p.prototype.toString=function(){return this._radii.toString()},p.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,i,n){i=a.defaultValue(i,0);const r=this._squaredXOverSquaredZ;if(a.defined(n)||(n=new t.Cartesian3),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-i))return n};const R=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],w=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function M(e,t,i){const a=.5*(t+e),n=.5*(t-e);let r=0;for(let e=0;e<5;e++){const t=n*R[e];r+=w[e]*(i(a+t)+i(a-t))}return r*=n,r}p.prototype.surfaceArea=function(e){const t=e.west;let i=e.east;const a=e.south,r=e.north;for(;i<t;)i+=n.CesiumMath.TWO_PI;const o=this._radiiSquared,u=o.x,s=o.y,d=o.z,c=u*s;return M(a,r,(function(e){const a=Math.cos(e),n=Math.sin(e);return Math.cos(e)*M(t,i,(function(e){const t=Math.cos(e),i=Math.sin(e);return Math.sqrt(c*n*n+d*(s*t*t+u*i*i)*a*a)}))}))},e.Cartographic=s,e.Ellipsoid=p}));
