define(["exports","./Transforms-51e2663f","./Matrix2-115e2170","./Matrix4-3b2c0630","./Ellipsoid-119327cb","./RuntimeError-8952249c","./defaultValue-81eec7ed","./EllipsoidTangentPlane-6354c9aa","./Math-c2b1b304","./Plane-f0451b7c"],(function(a,t,e,n,r,i,s,o,c,C){"use strict";function u(a,t){this.center=n.Cartesian3.clone(s.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=n.Matrix3.clone(s.defaultValue(t,n.Matrix3.ZERO))}u.packedLength=n.Cartesian3.packedLength+n.Matrix3.packedLength,u.pack=function(a,t,e){return e=s.defaultValue(e,0),n.Cartesian3.pack(a.center,t,e),n.Matrix3.pack(a.halfAxes,t,e+n.Cartesian3.packedLength),t},u.unpack=function(a,t,e){return t=s.defaultValue(t,0),s.defined(e)||(e=new u),n.Cartesian3.unpack(a,t,e.center),n.Matrix3.unpack(a,t+n.Cartesian3.packedLength,e.halfAxes),e};const l=new n.Cartesian3,d=new n.Cartesian3,h=new n.Cartesian3,x=new n.Cartesian3,m=new n.Cartesian3,M=new n.Cartesian3,f=new n.Matrix3,p={unitary:new n.Matrix3,diagonal:new n.Matrix3};u.fromPoints=function(a,t){if(s.defined(t)||(t=new u),!s.defined(a)||0===a.length)return t.halfAxes=n.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;let e;const r=a.length,i=n.Cartesian3.clone(a[0],l);for(e=1;e<r;e++)n.Cartesian3.add(i,a[e],i);const o=1/r;n.Cartesian3.multiplyByScalar(i,o,i);let c,C=0,w=0,g=0,b=0,y=0,N=0;for(e=0;e<r;e++)c=n.Cartesian3.subtract(a[e],i,d),C+=c.x*c.x,w+=c.x*c.y,g+=c.x*c.z,b+=c.y*c.y,y+=c.y*c.z,N+=c.z*c.z;C*=o,w*=o,g*=o,b*=o,y*=o,N*=o;const T=f;T[0]=C,T[1]=w,T[2]=g,T[3]=w,T[4]=b,T[5]=y,T[6]=g,T[7]=y,T[8]=N;const O=n.Matrix3.computeEigenDecomposition(T,p),A=n.Matrix3.clone(O.unitary,t.halfAxes);let P=n.Matrix3.getColumn(A,0,x),I=n.Matrix3.getColumn(A,1,m),R=n.Matrix3.getColumn(A,2,M),E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,U=-Number.MAX_VALUE,L=Number.MAX_VALUE,z=Number.MAX_VALUE,B=Number.MAX_VALUE;for(e=0;e<r;e++)c=a[e],E=Math.max(n.Cartesian3.dot(P,c),E),S=Math.max(n.Cartesian3.dot(I,c),S),U=Math.max(n.Cartesian3.dot(R,c),U),L=Math.min(n.Cartesian3.dot(P,c),L),z=Math.min(n.Cartesian3.dot(I,c),z),B=Math.min(n.Cartesian3.dot(R,c),B);P=n.Cartesian3.multiplyByScalar(P,.5*(L+E),P),I=n.Cartesian3.multiplyByScalar(I,.5*(z+S),I),R=n.Cartesian3.multiplyByScalar(R,.5*(B+U),R);const V=n.Cartesian3.add(P,I,t.center);n.Cartesian3.add(V,R,V);const _=h;return _.x=E-L,_.y=S-z,_.z=U-B,n.Cartesian3.multiplyByScalar(_,.5,_),n.Matrix3.multiplyByScale(t.halfAxes,_,t.halfAxes),t};const w=new n.Cartesian3,g=new n.Cartesian3;function b(a,t,e,r,i,o,c,C,l,d,h){s.defined(h)||(h=new u);const x=h.halfAxes;n.Matrix3.setColumn(x,0,t,x),n.Matrix3.setColumn(x,1,e,x),n.Matrix3.setColumn(x,2,r,x);let m=w;m.x=(i+o)/2,m.y=(c+C)/2,m.z=(l+d)/2;const M=g;M.x=(o-i)/2,M.y=(C-c)/2,M.z=(d-l)/2;const f=h.center;return m=n.Matrix3.multiplyByVector(x,m,m),n.Cartesian3.add(a,m,f),n.Matrix3.multiplyByScale(x,M,x),h}const y=new r.Cartographic,N=new n.Cartesian3,T=new r.Cartographic,O=new r.Cartographic,A=new r.Cartographic,P=new r.Cartographic,I=new r.Cartographic,R=new n.Cartesian3,E=new n.Cartesian3,S=new n.Cartesian3,U=new n.Cartesian3,L=new n.Cartesian3,z=new e.Cartesian2,B=new e.Cartesian2,V=new e.Cartesian2,_=new e.Cartesian2,k=new e.Cartesian2,W=new n.Cartesian3,X=new n.Cartesian3,q=new n.Cartesian3,D=new n.Cartesian3,j=new e.Cartesian2,Z=new n.Cartesian3,v=new n.Cartesian3,Y=new n.Cartesian3,G=new C.Plane(n.Cartesian3.UNIT_X,0);u.fromRectangle=function(a,t,i,u,l){let d,h,x,m,M,f,p;if(t=s.defaultValue(t,0),i=s.defaultValue(i,0),u=s.defaultValue(u,r.Ellipsoid.WGS84),a.width<=c.CesiumMath.PI){const n=e.Rectangle.center(a,y),s=u.cartographicToCartesian(n,N),c=new o.EllipsoidTangentPlane(s,u);p=c.plane;const w=n.longitude,g=a.south<0&&a.north>0?0:n.latitude,W=r.Cartographic.fromRadians(w,a.north,i,T),X=r.Cartographic.fromRadians(a.west,a.north,i,O),q=r.Cartographic.fromRadians(a.west,g,i,A),D=r.Cartographic.fromRadians(a.west,a.south,i,P),j=r.Cartographic.fromRadians(w,a.south,i,I),Z=u.cartographicToCartesian(W,R);let v=u.cartographicToCartesian(X,E);const Y=u.cartographicToCartesian(q,S);let G=u.cartographicToCartesian(D,U);const F=u.cartographicToCartesian(j,L),H=c.projectPointToNearestOnPlane(Z,z),J=c.projectPointToNearestOnPlane(v,B),K=c.projectPointToNearestOnPlane(Y,V),Q=c.projectPointToNearestOnPlane(G,_),$=c.projectPointToNearestOnPlane(F,k);return d=Math.min(J.x,K.x,Q.x),h=-d,m=Math.max(J.y,H.y),x=Math.min(Q.y,$.y),X.height=D.height=t,v=u.cartographicToCartesian(X,E),G=u.cartographicToCartesian(D,U),M=Math.min(C.Plane.getPointDistance(p,v),C.Plane.getPointDistance(p,G)),f=i,b(c.origin,c.xAxis,c.yAxis,c.zAxis,d,h,x,m,M,f,l)}const w=a.south>0,g=a.north<0,F=w?a.south:g?a.north:0,H=e.Rectangle.center(a,y).longitude,J=n.Cartesian3.fromRadians(H,F,i,u,W);J.z=0;const K=Math.abs(J.x)<c.CesiumMath.EPSILON10&&Math.abs(J.y)<c.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(J,X),Q=n.Cartesian3.UNIT_Z,$=n.Cartesian3.cross(K,Q,q);p=C.Plane.fromPointNormal(J,K,G);const aa=n.Cartesian3.fromRadians(H+c.CesiumMath.PI_OVER_TWO,F,i,u,D);h=n.Cartesian3.dot(C.Plane.projectPointOntoPlane(p,aa,j),$),d=-h,m=n.Cartesian3.fromRadians(0,a.north,g?t:i,u,Z).z,x=n.Cartesian3.fromRadians(0,a.south,w?t:i,u,v).z;const ta=n.Cartesian3.fromRadians(a.east,F,i,u,Y);return M=C.Plane.getPointDistance(p,ta),f=0,b(J,$,Q,K,d,h,x,m,M,f,l)},u.fromTransformation=function(a,t){return s.defined(t)||(t=new u),t.center=n.Matrix4.getTranslation(a,t.center),t.halfAxes=n.Matrix4.getMatrix3(a,t.halfAxes),t.halfAxes=n.Matrix3.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},u.clone=function(a,t){if(s.defined(a))return s.defined(t)?(n.Cartesian3.clone(a.center,t.center),n.Matrix3.clone(a.halfAxes,t.halfAxes),t):new u(a.center,a.halfAxes)},u.intersectPlane=function(a,e){const r=a.center,i=e.normal,s=a.halfAxes,o=i.x,c=i.y,C=i.z,u=Math.abs(o*s[n.Matrix3.COLUMN0ROW0]+c*s[n.Matrix3.COLUMN0ROW1]+C*s[n.Matrix3.COLUMN0ROW2])+Math.abs(o*s[n.Matrix3.COLUMN1ROW0]+c*s[n.Matrix3.COLUMN1ROW1]+C*s[n.Matrix3.COLUMN1ROW2])+Math.abs(o*s[n.Matrix3.COLUMN2ROW0]+c*s[n.Matrix3.COLUMN2ROW1]+C*s[n.Matrix3.COLUMN2ROW2]),l=n.Cartesian3.dot(i,r)+e.distance;return l<=-u?t.Intersect.OUTSIDE:l>=u?t.Intersect.INSIDE:t.Intersect.INTERSECTING};const F=new n.Cartesian3,H=new n.Cartesian3,J=new n.Cartesian3,K=new n.Cartesian3,Q=new n.Cartesian3,$=new n.Cartesian3;u.distanceSquaredTo=function(a,t){const e=n.Cartesian3.subtract(t,a.center,w),r=a.halfAxes;let i=n.Matrix3.getColumn(r,0,F),s=n.Matrix3.getColumn(r,1,H),o=n.Matrix3.getColumn(r,2,J);const C=n.Cartesian3.magnitude(i),u=n.Cartesian3.magnitude(s),l=n.Cartesian3.magnitude(o);let d=!0,h=!0,x=!0;C>0?n.Cartesian3.divideByScalar(i,C,i):d=!1,u>0?n.Cartesian3.divideByScalar(s,u,s):h=!1,l>0?n.Cartesian3.divideByScalar(o,l,o):x=!1;const m=!d+!h+!x;let M,f,p;if(1===m){let a=i;M=s,f=o,h?x||(a=o,f=i):(a=s,M=i),p=n.Cartesian3.cross(M,f,Q),a===i?i=p:a===s?s=p:a===o&&(o=p)}else if(2===m){M=i,h?M=s:x&&(M=o);let a=n.Cartesian3.UNIT_Y;a.equalsEpsilon(M,c.CesiumMath.EPSILON3)&&(a=n.Cartesian3.UNIT_X),f=n.Cartesian3.cross(M,a,K),n.Cartesian3.normalize(f,f),p=n.Cartesian3.cross(M,f,Q),n.Cartesian3.normalize(p,p),M===i?(s=f,o=p):M===s?(o=f,i=p):M===o&&(i=f,s=p)}else 3===m&&(i=n.Cartesian3.UNIT_X,s=n.Cartesian3.UNIT_Y,o=n.Cartesian3.UNIT_Z);const g=$;g.x=n.Cartesian3.dot(e,i),g.y=n.Cartesian3.dot(e,s),g.z=n.Cartesian3.dot(e,o);let b,y=0;return g.x<-C?(b=g.x+C,y+=b*b):g.x>C&&(b=g.x-C,y+=b*b),g.y<-u?(b=g.y+u,y+=b*b):g.y>u&&(b=g.y-u,y+=b*b),g.z<-l?(b=g.z+l,y+=b*b):g.z>l&&(b=g.z-l,y+=b*b),y};const aa=new n.Cartesian3,ta=new n.Cartesian3;u.computePlaneDistances=function(a,e,r,i){s.defined(i)||(i=new t.Interval);let o=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;const C=a.center,u=a.halfAxes,l=n.Matrix3.getColumn(u,0,F),d=n.Matrix3.getColumn(u,1,H),h=n.Matrix3.getColumn(u,2,J),x=n.Cartesian3.add(l,d,aa);n.Cartesian3.add(x,h,x),n.Cartesian3.add(x,C,x);const m=n.Cartesian3.subtract(x,e,ta);let M=n.Cartesian3.dot(r,m);return o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.add(C,l,x),n.Cartesian3.add(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.add(C,l,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.add(C,l,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.subtract(C,l,x),n.Cartesian3.add(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.subtract(C,l,x),n.Cartesian3.add(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.subtract(C,l,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),n.Cartesian3.subtract(C,l,x),n.Cartesian3.subtract(x,d,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,e,m),M=n.Cartesian3.dot(r,m),o=Math.min(M,o),c=Math.max(M,c),i.start=o,i.stop=c,i};const ea=new n.Cartesian3,na=new n.Cartesian3,ra=new n.Cartesian3;u.computeCorners=function(a,t){s.defined(t)||(t=[new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3,new n.Cartesian3]);const e=a.center,r=a.halfAxes,i=n.Matrix3.getColumn(r,0,ea),o=n.Matrix3.getColumn(r,1,na),c=n.Matrix3.getColumn(r,2,ra);return n.Cartesian3.clone(e,t[0]),n.Cartesian3.subtract(t[0],i,t[0]),n.Cartesian3.subtract(t[0],o,t[0]),n.Cartesian3.subtract(t[0],c,t[0]),n.Cartesian3.clone(e,t[1]),n.Cartesian3.subtract(t[1],i,t[1]),n.Cartesian3.subtract(t[1],o,t[1]),n.Cartesian3.add(t[1],c,t[1]),n.Cartesian3.clone(e,t[2]),n.Cartesian3.subtract(t[2],i,t[2]),n.Cartesian3.add(t[2],o,t[2]),n.Cartesian3.subtract(t[2],c,t[2]),n.Cartesian3.clone(e,t[3]),n.Cartesian3.subtract(t[3],i,t[3]),n.Cartesian3.add(t[3],o,t[3]),n.Cartesian3.add(t[3],c,t[3]),n.Cartesian3.clone(e,t[4]),n.Cartesian3.add(t[4],i,t[4]),n.Cartesian3.subtract(t[4],o,t[4]),n.Cartesian3.subtract(t[4],c,t[4]),n.Cartesian3.clone(e,t[5]),n.Cartesian3.add(t[5],i,t[5]),n.Cartesian3.subtract(t[5],o,t[5]),n.Cartesian3.add(t[5],c,t[5]),n.Cartesian3.clone(e,t[6]),n.Cartesian3.add(t[6],i,t[6]),n.Cartesian3.add(t[6],o,t[6]),n.Cartesian3.subtract(t[6],c,t[6]),n.Cartesian3.clone(e,t[7]),n.Cartesian3.add(t[7],i,t[7]),n.Cartesian3.add(t[7],o,t[7]),n.Cartesian3.add(t[7],c,t[7]),t};const ia=new n.Matrix3;u.computeTransformation=function(a,t){s.defined(t)||(t=new n.Matrix4);const e=a.center,r=n.Matrix3.multiplyByUniformScale(a.halfAxes,2,ia);return n.Matrix4.fromRotationTranslation(r,e,t)};const sa=new t.BoundingSphere;u.isOccluded=function(a,e){const n=t.BoundingSphere.fromOrientedBoundingBox(a,sa);return!e.isBoundingSphereVisible(n)},u.prototype.intersectPlane=function(a){return u.intersectPlane(this,a)},u.prototype.distanceSquaredTo=function(a){return u.distanceSquaredTo(this,a)},u.prototype.computePlaneDistances=function(a,t,e){return u.computePlaneDistances(this,a,t,e)},u.prototype.computeCorners=function(a){return u.computeCorners(this,a)},u.prototype.computeTransformation=function(a){return u.computeTransformation(this,a)},u.prototype.isOccluded=function(a){return u.isOccluded(this,a)},u.equals=function(a,t){return a===t||s.defined(a)&&s.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&n.Matrix3.equals(a.halfAxes,t.halfAxes)},u.prototype.clone=function(a){return u.clone(this,a)},u.prototype.equals=function(a){return u.equals(this,a)},a.OrientedBoundingBox=u}));
